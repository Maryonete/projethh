<!-- Association ayant repondues -->
{% if (repondu == 'ok') %}
<table class="table table-striped table-hover sortTable w-100" id="assoListOk">
  <caption>
    Liste des associations
  </caption>
  <thead>
    <tr class="text-center">
      <th scope="col">Code asso</th>
      <th scope="col">Association</th>
      <th scope="col">Date de réponse</th>
      <th scope="col">Personne ayant renseigné le questionnaire</th>
    </tr>
  </thead>
  <tbody>
    {% for campainAssociation in campainAssociations %} {% if
    (campainAssociation.statut == 'updated') %}
    <tr>
      <td>{{ campainAssociation.association.code }}</td>
      <td>
        <a
          href="{{
            path('asso_show', { id: campainAssociation.association.id })
          }}"
          title="Visualiser"
          alt="lien vers l'association"
        >
          {{ campainAssociation.association.libelle }}
        </a>
      </td>
      <td>
        {{ campainAssociation.updatedTextAt 
          ? 
          campainAssociation.updatedTextAt|date('d/m/Y H:i') 
          : ' - '
        }}
      </td>
      <td>
        {{
          campainAssociation.updatedby
            ? campainAssociation.updatedby == "referent"
              ? "référent"
              : "administrateur"
            : ""
        }}
      </td>
      <td>
        <a
          href="{{
            path('asso_editTextePersonnalise', {
              id: campainAssociation.id
            })
          }}"
          class="flex-grow-1 mx-2"
          title="Lien pour association"
          ><i class="fas fa-pencil-alt"></i
        ></a>
      </td>
    </tr>
    {% endif %} {% endfor %}
  </tbody>
</table>
<script>
  $(document).ready(function () {
    $("#assoListOk").DataTable({
      order: [2, "asc"],
      searching: true,
      info: false,
      paging: false,
      language: {
        sSearch: "<i class='fas fa-search'></i>",
      },
      columns: [null, null, null, null, { orderable: false }],
    });
  });
</script>
{% else %}
<!-- Association en attentes -->
<a class="btn btn-light btn-sm" id="relancerAttente"> Relancer par mail </a>
<table
  class="table table-striped table-hover sortTable w-100"
  id="assoListAttente"
>
  <caption>
    Liste des associations en attente
  </caption>
  <thead>
    <tr class="text-center">
      <th scope="col">Code asso</th>
      <th scope="col">Association</th>
      <th scope="col">Statut</th>
      <th scope="col">Envoyé le</th>
      <th scope="col">Lien</th>
    </tr>
  </thead>
  <tbody>
    {% for campainAssociation in campainAssociations %} {% if
    (campainAssociation.statut == 'send') %}
    <tr>
      <td>{{ campainAssociation.association.code }}</td>
      <td>
        <a
          href="{{
            path('asso_show', { id: campainAssociation.association.id })
          }}"
          title="Visualiser"
          alt="lien vers l'association"
        >
          {{ campainAssociation.association.libelle }}
        </a>
      </td>
      <td>En attente</td>

      <td>
        <i class="fas fa-envelope"></i>
        {{ campainAssociation.sendAt ? campainAssociation.sendAt|date('d/m/Y à H:i') : 'Non envoyé' }}
      </td>

      <td>
        <a
          href="{{
            path('associationhh', {
              token: campainAssociation.token
            })
          }}"
          class="flex-grow-1 mx-2"
          title="Lien pour association"
          target="_blank"
          ><i class="fa-solid fa-link"></i
        ></a>
      </td>

      <td>
        <a
          href="{{
            path('asso_editTextePersonnalise', {
              id: campainAssociation.id
            })
          }}"
          class="flex-grow-1 mx-2"
          title="Lien pour association"
          ><i class="fas fa-pencil-alt"></i
        ></a>
      </td>
    </tr>
    {% endif %} {% endfor %}
  </tbody>
</table>
<script>
  $(document).ready(function () {
    $("#assoListAttente").DataTable({
      order: [2, "asc"],
      searching: true,
      info: false,
      paging: false,
      language: {
        sSearch: "<i class='fas fa-search'></i>",
      },
      columns: [
        null,
        null,
        null,
        null,
        { orderable: false },
        { orderable: false },
      ],
    });
  });
</script>
{%endif %}
